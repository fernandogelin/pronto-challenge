<!DOCTYPE html>
<meta charset="utf-8">
<html>
  <head>
    <style>
rect.highlight {
	color: gray;
}
.q11{fill:rgb(0, 0, 0)!important}
.q10{fill:rgb(0, 29, 43)!important}
.q9{fill:rgb(0, 59, 73)!important}
.q8{fill:rgb(0, 79, 93)!important}
.q7{fill:rgb(0, 99, 113)!important}
.q6{fill:rgb(0, 119, 133)!important}
.q5{fill:rgb(0, 139, 153)!important}
.q4{fill:rgb(0, 159, 173)!important}
.q3{fill:rgb(0, 189, 203)!important}
.q2{fill:rgb(0, 209, 223)!important}
.q1{fill:#97F7FD!important}
.graph-label {
  font-family: 'Titillium Web';
  font-size:1em !important;
}
textpath {
  font-family: 'Bitter';
  font-size: 2em;
}
#info {
  height: 100px;
  width: 100px;
  position: absolute;
  bottom: -140px;
  left: 250px;
  font-family: 'Titillium Web';
  font-size: 2em;
  font-weight: bold;
}
#circular-annual {
  position: relative;
}
#circular-short {
  position: absolute;
}

  </style>
	<link rel="stylesheet" href="//cdn.jsdelivr.net/cal-heatmap/3.3.10/cal-heatmap.css" />
  <link href='https://fonts.googleapis.com/css?family=Bitter:400,400italic,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Titillium+Web:400,200,200italic,300,300italic,400italic,600,600italic,700,700italic,900' rel='stylesheet' type='text/css'>
  <script src="http://d3js.org/d3.v3.js"></script>
	<script type="text/javascript" src="//cdn.jsdelivr.net/cal-heatmap/3.3.10/cal-heatmap.min.js"></script>
  <script src="circularHeatChart.js"></script>
  <script src="http://rawgit.com/jashkenas/coffee-script/master/extras/coffee-script.js"></script>
  </head>

  <body>
  <div id="cal-annual"></div>
  <div id="cal-short"></div>
	<div id="circular-annual"></div>
  <div id="circular-short"></div>
  <div id="info"></div>
	<script type="text/coffeescript">

twoDigit = (number) ->
  number = if number < 10 then '0' + number else number


calAnnual = new CalHeatMap()
calAnnual.init
  itemSelector: "#cal-annual"
  start: new Date(2014, 9, 14)
  range: 13
  cellSize: 13
  cellRadius: 2
  cellPadding: 1
  legend: [10,30,80,150,200,240,300,350,400,600,630]
  domain: "month",
  subDomain: "x_day",
  data: "timestamp_annual.json"

calShort = new CalHeatMap()
calShort.init
  itemSelector: "#cal-short"
  start: new Date(2014, 9, 14)
  range: 13
  cellSize: 13
  cellRadius: 2
  cellPadding: 1
  legend: [10,30,80,150,200,240,300,350,400,600,630]
  domain: "month",
  subDomain: "x_day",
  data: "timestamp_short.json"

minuteData = [16,20,16,31,16,25,25,18,27,21,31,12,16,19,25,13,17,20,17,23,20,14,13,17,19,17,20,20,14,26,23,19,12,14,11,18,21,12,23,16,10,19,13,14,17,18,24,10,11,14,9,18,11,20,8,5,12,12,8,12,20,18,9,14,16,14,11,13,14,11,9,8,16,9,9,7,13,13,9,7,19,12,9,5,7,9,11,11,12,16,13,9,10,14,5,12,19,15,9,10,8,10,16,7,11,9,9,9,13,7,16,9,10,13,6,10,19,10,13,10,10,8,11,13,3,13,7,17,2,12,16,6,9,9,6,10,6,13,11,8,7,12,13,10,7,6,5,5,9,10,11,8,11,6,5,5,5,4,6,9,9,4,4,7,8,8,5,4,7,3,8,8,11,12,5,7,7,5,8,4,1,4,1,5,5,1,1,3,1,8,4,7,5,1,3,7,3,4,3,2,4,5,1,4,2,2,1,1,3,1,5,1,2,1,4,3,5,5,6,3,4,7,6,4,2,6,2,1,2,1,2,3,3,7,6,2,6,3,4,8,6,11,10,20,17,13,13,7,8,8,1,4,5,10,7,6,6,3,1,2,4,4,1,1,3,1,2,5,2,5,7,3,3,5,5,6,3,3,4,5,4,8,4,8,2,5,2,5,6,2,3,4,4,3,6,5,4,6,6,2,5,4,2,5,4,2,2,9,11,8,4,3,3,6,8,4,10,8,11,28,20,12,10,10,8,9,11,18,15,7,18,13,17,29,23,29,18,23,23,12,24,38,37,46,29,23,26,33,23,27,27,28,22,22,20,24,18,31,22,18,19,22,19,19,24,21,21,19,15,13,17,19,16,20,29,37,52,36,42,28,29,31,23,26,27,32,31,30,39,27,32,36,29,52,34,37,34,47,28,40,33,44,37,46,50,42,37,36,40,36,40,34,36,37,42,62,54,60,58,61,59,54,54,64,48,62,58,68,69,56,48,56,55,61,55,77,59,84,82,80,88,97,81,87,74,78,115,92,96,106,122,104,118,150,132,118,128,131,127,159,140,174,172,176,165,166,146,165,179,150,142,159,133,165,114,149,155,167,162,130,165,157,146,151,139,143,174,164,186,183,163,161,186,185,186,186,166,178,193,182,175,197,188,180,178,177,178,183,176,184,218,215,223,204,200,203,192,201,200,198,209,203,209,181,198,208,236,200,186,183,196,204,201,157,169,170,149,179,184,163,157,157,172,156,171,165,149,134,183,163,164,161,164,180,191,167,172,213,189,151,194,166,165,160,163,148,144,164,166,155,143,140,158,152,125,172,157,182,177,151,160,153,183,160,180,176,166,178,156,157,156,150,146,122,122,137,136,134,113,110,116,114,135,141,138,136,148,134,136,152,150,149,140,118,128,139,146,140,134,124,106,102,123,110,117,118,133,117,141,144,105,111,119,118,138,142,141,140,132,116,121,122,131,156,131,128,127,127,141,122,109,131,132,121,141,148,141,118,142,142,159,141,148,123,140,137,129,127,130,137,116,144,165,172,127,116,120,121,137,124,172,153,140,127,133,153,125,129,179,141,156,154,147,135,148,126,164,154,147,162,136,161,171,153,169,156,180,190,189,171,171,196,162,147,163,153,144,158,166,121,156,158,174,169,158,202,171,157,185,158,174,142,165,131,164,151,145,174,155,148,177,132,169,154,160,157,171,167,153,147,167,162,147,153,178,153,169,158,162,155,138,137,152,180,150,165,181,154,162,153,164,189,161,157,158,184,161,176,161,150,150,157,143,179,164,155,145,155,177,146,158,161,168,165,158,183,154,162,176,160,166,164,155,152,147,142,172,191,163,156,178,193,167,167,147,161,138,160,177,152,143,151,164,162,163,161,144,148,144,139,167,161,143,150,139,147,149,167,127,146,138,163,169,156,134,128,142,159,148,144,141,167,153,165,124,143,153,141,163,173,158,140,137,145,134,155,161,153,148,129,158,140,147,149,128,170,156,172,180,162,129,148,168,186,171,146,153,152,148,146,149,176,164,133,165,136,154,134,142,168,171,176,158,156,147,168,171,144,186,152,176,167,151,159,160,146,157,160,172,154,153,165,158,144,169,137,158,166,178,173,190,151,171,172,161,171,155,178,155,160,191,183,156,157,170,160,177,169,164,187,205,184,195,178,144,183,153,154,198,194,179,198,177,196,200,180,216,189,210,160,180,211,181,181,182,171,189,162,193,188,177,201,200,210,186,193,196,180,170,185,179,190,180,199,211,189,203,198,192,216,221,238,197,229,189,210,219,225,208,212,187,209,184,209,212,218,215,242,286,258,250,269,282,260,258,245,258,285,268,241,263,251,266,257,257,254,289,270,239,234,218,253,269,234,254,215,219,239,227,250,247,249,215,213,206,218,225,217,247,207,221,212,197,214,216,211,226,201,202,202,208,189,200,217,210,193,202,206,186,187,199,198,175,169,203,200,180,187,222,197,188,186,200,183,227,184,208,183,180,188,172,171,170,169,153,172,166,152,164,125,170,171,150,156,170,156,156,164,176,195,135,170,163,145,151,164,155,154,159,154,147,129,155,135,157,123,141,142,115,134,122,126,133,116,123,125,125,147,122,110,115,130,132,131,136,157,133,127,126,108,105,110,129,134,132,94,110,117,122,110,100,101,106,112,108,108,109,103,126,104,96,97,98,114,109,97,100,90,108,101,91,109,100,83,107,92,97,83,96,83,95,82,89,95,81,93,77,77,103,92,86,112,82,78,87,95,88,91,73,74,79,90,74,62,80,83,81,64,73,73,79,92,68,94,77,83,71,82,77,89,84,65,85,59,57,57,60,49,78,64,84,65,77,76,60,59,71,73,73,66,67,57,78,67,63,76,80,56,72,74,70,73,89,88,83,70,66,61,89,67,77,53,71,70,49,54,63,55,56,56,58,52,47,58,48,50,45,56,61,72,47,56,70,54,50,71,58,46,38,40,62,62,51,40,46,49,54,60,67,42,36,39,49,59,51,45,43,38,51,40,32,43,47,43,56,46,67,35,44,46,47,40,39,33,43,49,45,35,32,45,41,34,34,35,37,41,44,38,31,41,34,43,43,28,36,31,41,40,35,28,33,25,26,37,38,50,44,37,51,27,43,31,26,35,34,26,28,28,37,29,38,39,34,32,38,32,32,24,35,31,21,29,30,23,33,34,30,20,27,32,27,26,20,37,44,27,21,14,32,27,22,21,20,30,19,20,22,26,22,15,15,23,19,25,35]
hourDataTotal = [1022, 682, 478, 192, 316, 905, 1855, 6093, 10967, 9751, 7761, 8864, 9571, 9575, 9096, 9850, 11629, 14163, 10382, 6939, 4792, 3730, 2484, 1749]
hourDataAnnual = [571,341,178,89,241,731,1591,5428,9661,7708,4657,4735,4816,4349,3580,4348,6485,9588,6709,4198,2741,2229,1416,970]
hourDataShort = [451,341,300,103,75,174,264,665,1306,2043,3104,4129,4755,5226,5516,5502,5144,4575,3673,2741,2051,1501,1068,779]

circularAnnual = circularHeatChart()
  .innerRadius 40
  .radialLabels null
  .numSegments 12
  .segmentHeight 80
  .segmentLabels null
  .range ['#92E9FA','#043440']
  .margin {top: 30, right: 0, bottom: 20, left: 60}

d3.select "#circular-annual"
  .selectAll('svg')
  .data([hourDataAnnual.slice(0,12)])
  .enter()
  .append('svg')
  .style('height', '500px')
  .style('width', '800px')
  .call(circularAnnual)

d3.selectAll("#circular-annual path").on 'mouseover', ->
  d = d3.select(this).data()[0]
  d3.select("#info").text(twoDigit Math.round(d/365) )

d3.selectAll("#circular-annual svg").on 'mouseout', ->
    d3.select("#info").text('')

circularShort = circularHeatChart()
  .innerRadius 40
  .radialLabels null
  .numSegments 12
  .segmentHeight 80
  .segmentLabels null
  .range ['#92E9FA','#043440']
  .margin {top: 30, right: 0, bottom: 20, left: 60}

d3.select "#circular-short"
  .selectAll('svg')
  .data([hourDataShort.slice(0,12)])
  .enter()
  .append('svg')
  .style('height', '500px')
  .style('width', '800px')
  .call(circularShort)

d3.selectAll("#circular-short path").on 'mouseover', ->
  d = d3.select(this).data()[0]
  d3.select("#info").text(twoDigit Math.round(d/365) )

d3.selectAll("#circular-short svg").on 'mouseout', ->
    d3.select("#info").text('')

color = d3.scale.linear().range(['#97F7FD','#006371']);
	</script>
  </body>
</html>
